<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>모바일 청첩장</title>
</head>

<body>
  <h1>청첩장</h1>
  <h2>거짓말 아님!</h2>
  <p>
    <span id="text-seconds">5.0</span>초만 기다리세요.<br />
    링크 공유할때 뜨는 미리보기 이미지가 부담스러워서 만든 페이지<br />
  </p>

  <ul>
    <li>
      <a href="https://www.barunsonmcard.com/m/bhby0427">
        인내심 없는 사람을 위한 링크
      </a>
    </li>
    <li>
      <a href="https://github.com/if1live/april-fools">
        깃헙 스타수는 식사 인원수 측정에 사용될지도?
      </a>
    </li>
  </ul>

  <script type="text/javascript">
    function redirect() {
      // console.log("redirect");
      const nextUrl = "https://www.barunsonmcard.com/m/bhby0427";
      // const nextUrl = "https://naver.com";
      window.location.href = nextUrl;
    }

    /** @param {number} v */
    function updateWaitTime(v) {
      const text = v.toFixed(1);
      document.getElementById("text-seconds").innerHTML = text;
    }

    const startTime = Date.now();
    const finishTime = startTime + 5000;

    // 리다이렉트가 1번만 실행되게 보장하지 않으면 사파리에서 이상현상 발생하는거로 추정
    const timer = setInterval(() => {
      const now = Date.now();
      const remain = finishTime - now;
      if (remain <= 0) {
        redirect();
        clearInterval(timer);
      } else {
        updateWaitTime(remain / 1000);
      }
    }, 100);
  </script>
</body>
